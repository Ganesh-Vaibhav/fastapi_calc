============================= test session starts ==============================
platform darwin -- Python 3.13.2, pytest-8.3.3, pluggy-1.5.0 -- /Users/kishorereddy/miniconda3/bin/python
cachedir: .pytest_cache
rootdir: /Users/kishorereddy/Desktop/fastapi_calc
configfile: pytest.ini
plugins: cov-6.0.0, pylint-0.21.0, anyio-4.6.2.post1
collecting ... collected 14 items

tests/integration/test_calculation_model.py::test_create_calculation PASSED [  7%]
tests/integration/test_calculation_routes.py::test_create_calculation FAILED [ 14%]
tests/integration/test_calculation_routes.py::test_read_calculations FAILED [ 21%]
tests/integration/test_calculation_routes.py::test_read_calculation_by_id FAILED [ 28%]
tests/integration/test_calculation_routes.py::test_update_calculation FAILED [ 35%]
tests/integration/test_calculation_routes.py::test_delete_calculation FAILED [ 42%]
tests/integration/test_calculation_routes.py::test_invalid_calculation_type FAILED [ 50%]
tests/integration/test_fastapi_calculator.py::test_add_api PASSED        [ 57%]
tests/integration/test_fastapi_calculator.py::test_subtract_api PASSED   [ 64%]
tests/integration/test_fastapi_calculator.py::test_multiply_api PASSED   [ 71%]
tests/integration/test_fastapi_calculator.py::test_divide_api PASSED     [ 78%]
tests/integration/test_fastapi_calculator.py::test_divide_by_zero_api PASSED [ 85%]
tests/integration/test_user_model_and_endpoints.py::test_create_user_and_uniqueness FAILED [ 92%]
tests/integration/test_user_model_and_endpoints.py::test_login_user FAILED [100%]

=================================== FAILURES ===================================
___________________________ test_create_calculation ____________________________

client = <starlette.testclient.TestClient object at 0x112514d70>
db_session = <sqlalchemy.orm.session.Session object at 0x112515160>

    def test_create_calculation(client, db_session):
        # First create a user
        user_data = {"username": "calcuser", "email": "calc@example.com", "password": "password123"}
>       client.post("/users/register", json=user_data)

tests/integration/test_calculation_routes.py:7: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:593: in post
    return super().post(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1157: in post
    return self.request(
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:484: in request
    return super().request(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:837: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:926: in send
    response = self._send_handling_auth(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:954: in _send_handling_auth
    response = self._send_handling_redirects(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:991: in _send_handling_redirects
    response = self._send_single_request(request)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1027: in _send_single_request
    response = transport.handle_request(request)
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:377: in handle_request
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:374: in handle_request
    portal.call(self.app, scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:456: in result
    return self.__get_result()
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../../miniconda3/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:715: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:735: in app
    await route.handle(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:301: in app
    raw_response = await run_endpoint_function(
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:214: in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
../../miniconda3/lib/python3.13/site-packages/starlette/concurrency.py:39: in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
../../miniconda3/lib/python3.13/site-packages/anyio/to_thread.py:56: in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:2441: in run_sync_in_worker_thread
    return await future
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:943: in run
    result = context.run(func, *args)
app/users.py:27: in create_user
    password_hash=security.hash_password(user_in.password),
app/security.py:9: in hash_password
    return pwd_context.hash(password)
../../miniconda3/lib/python3.13/site-packages/passlib/context.py:2258: in hash
    return record.hash(secret, **kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:779: in hash
    self.checksum = self._calc_checksum(secret)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:591: in _calc_checksum
    self._stub_requires_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2254: in _stub_requires_backend
    cls.set_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2156: in set_backend
    return owner.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2163: in set_backend
    return cls.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2188: in set_backend
    cls._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2311: in _set_backend
    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2224: in _set_backend
    ok = loader(**kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:626: in _load_backend_mixin
    return mixin_cls._finalize_backend_mixin(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:421: in _finalize_backend_mixin
    if detect_wrap_bug(IDENT_2A):
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:380: in detect_wrap_bug
    if verify(secret, bug_hash):
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:792: in verify
    return consteq(self._calc_checksum(secret), chk)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <passlib.handlers.bcrypt._BcryptBackend object at 0x11263d6e0>
secret = b'01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345...7890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234'

    def _calc_checksum(self, secret):
        # bcrypt behavior:
        #   secret must be bytes
        #   config must be ascii bytes
        #   returns ascii bytes
        secret, ident = self._prepare_digest_args(secret)
        config = self._get_config(ident)
        if isinstance(config, unicode):
            config = config.encode("ascii")
>       hash = _bcrypt.hashpw(secret, config)
E       ValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])

../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:655: ValueError
----------------------------- Captured stdout call -----------------------------
DEBUG: Hashing password 'password123', type: <class 'str'>, length: 11
2025-12-01 23:35:38 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
------------------------------ Captured log call -------------------------------
WARNING  passlib.handlers.bcrypt:bcrypt.py:622 (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
____________________________ test_read_calculations ____________________________

client = <starlette.testclient.TestClient object at 0x1125af610>
db_session = <sqlalchemy.orm.session.Session object at 0x112655a90>

    def test_read_calculations(client, db_session):
        # Create user and calculation
>       client.post("/users/register", json={"username": "readuser", "email": "read@example.com", "password": "password123"})

tests/integration/test_calculation_routes.py:20: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:593: in post
    return super().post(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1157: in post
    return self.request(
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:484: in request
    return super().request(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:837: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:926: in send
    response = self._send_handling_auth(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:954: in _send_handling_auth
    response = self._send_handling_redirects(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:991: in _send_handling_redirects
    response = self._send_single_request(request)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1027: in _send_single_request
    response = transport.handle_request(request)
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:377: in handle_request
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:374: in handle_request
    portal.call(self.app, scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:456: in result
    return self.__get_result()
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../../miniconda3/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:715: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:735: in app
    await route.handle(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:301: in app
    raw_response = await run_endpoint_function(
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:214: in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
../../miniconda3/lib/python3.13/site-packages/starlette/concurrency.py:39: in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
../../miniconda3/lib/python3.13/site-packages/anyio/to_thread.py:56: in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:2441: in run_sync_in_worker_thread
    return await future
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:943: in run
    result = context.run(func, *args)
app/users.py:27: in create_user
    password_hash=security.hash_password(user_in.password),
app/security.py:9: in hash_password
    return pwd_context.hash(password)
../../miniconda3/lib/python3.13/site-packages/passlib/context.py:2258: in hash
    return record.hash(secret, **kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:779: in hash
    self.checksum = self._calc_checksum(secret)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:591: in _calc_checksum
    self._stub_requires_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2254: in _stub_requires_backend
    cls.set_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2156: in set_backend
    return owner.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2163: in set_backend
    return cls.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2188: in set_backend
    cls._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2311: in _set_backend
    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2224: in _set_backend
    ok = loader(**kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:626: in _load_backend_mixin
    return mixin_cls._finalize_backend_mixin(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:421: in _finalize_backend_mixin
    if detect_wrap_bug(IDENT_2A):
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:380: in detect_wrap_bug
    if verify(secret, bug_hash):
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:792: in verify
    return consteq(self._calc_checksum(secret), chk)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <passlib.handlers.bcrypt._BcryptBackend object at 0x11263ab50>
secret = b'01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345...7890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234'

    def _calc_checksum(self, secret):
        # bcrypt behavior:
        #   secret must be bytes
        #   config must be ascii bytes
        #   returns ascii bytes
        secret, ident = self._prepare_digest_args(secret)
        config = self._get_config(ident)
        if isinstance(config, unicode):
            config = config.encode("ascii")
>       hash = _bcrypt.hashpw(secret, config)
E       ValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])

../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:655: ValueError
----------------------------- Captured stdout call -----------------------------
DEBUG: Hashing password 'password123', type: <class 'str'>, length: 11
2025-12-01 23:35:38 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
------------------------------ Captured log call -------------------------------
WARNING  passlib.handlers.bcrypt:bcrypt.py:622 (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
_________________________ test_read_calculation_by_id __________________________

client = <starlette.testclient.TestClient object at 0x112657d90>
db_session = <sqlalchemy.orm.session.Session object at 0x1126560d0>

    def test_read_calculation_by_id(client, db_session):
>       client.post("/users/register", json={"username": "iduser", "email": "id@example.com", "password": "password123"})

tests/integration/test_calculation_routes.py:30: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:593: in post
    return super().post(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1157: in post
    return self.request(
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:484: in request
    return super().request(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:837: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:926: in send
    response = self._send_handling_auth(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:954: in _send_handling_auth
    response = self._send_handling_redirects(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:991: in _send_handling_redirects
    response = self._send_single_request(request)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1027: in _send_single_request
    response = transport.handle_request(request)
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:377: in handle_request
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:374: in handle_request
    portal.call(self.app, scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:456: in result
    return self.__get_result()
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../../miniconda3/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:715: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:735: in app
    await route.handle(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:301: in app
    raw_response = await run_endpoint_function(
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:214: in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
../../miniconda3/lib/python3.13/site-packages/starlette/concurrency.py:39: in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
../../miniconda3/lib/python3.13/site-packages/anyio/to_thread.py:56: in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:2441: in run_sync_in_worker_thread
    return await future
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:943: in run
    result = context.run(func, *args)
app/users.py:27: in create_user
    password_hash=security.hash_password(user_in.password),
app/security.py:9: in hash_password
    return pwd_context.hash(password)
../../miniconda3/lib/python3.13/site-packages/passlib/context.py:2258: in hash
    return record.hash(secret, **kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:779: in hash
    self.checksum = self._calc_checksum(secret)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:591: in _calc_checksum
    self._stub_requires_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2254: in _stub_requires_backend
    cls.set_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2156: in set_backend
    return owner.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2163: in set_backend
    return cls.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2188: in set_backend
    cls._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2311: in _set_backend
    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2224: in _set_backend
    ok = loader(**kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:626: in _load_backend_mixin
    return mixin_cls._finalize_backend_mixin(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:421: in _finalize_backend_mixin
    if detect_wrap_bug(IDENT_2A):
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:380: in detect_wrap_bug
    if verify(secret, bug_hash):
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:792: in verify
    return consteq(self._calc_checksum(secret), chk)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <passlib.handlers.bcrypt._BcryptBackend object at 0x1131fd8b0>
secret = b'01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345...7890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234'

    def _calc_checksum(self, secret):
        # bcrypt behavior:
        #   secret must be bytes
        #   config must be ascii bytes
        #   returns ascii bytes
        secret, ident = self._prepare_digest_args(secret)
        config = self._get_config(ident)
        if isinstance(config, unicode):
            config = config.encode("ascii")
>       hash = _bcrypt.hashpw(secret, config)
E       ValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])

../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:655: ValueError
----------------------------- Captured stdout call -----------------------------
DEBUG: Hashing password 'password123', type: <class 'str'>, length: 11
2025-12-01 23:35:39 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
------------------------------ Captured log call -------------------------------
WARNING  passlib.handlers.bcrypt:bcrypt.py:622 (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
___________________________ test_update_calculation ____________________________

client = <starlette.testclient.TestClient object at 0x1131b4050>
db_session = <sqlalchemy.orm.session.Session object at 0x1131b56e0>

    def test_update_calculation(client, db_session):
>       client.post("/users/register", json={"username": "updateuser", "email": "update@example.com", "password": "password123"})

tests/integration/test_calculation_routes.py:41: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:593: in post
    return super().post(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1157: in post
    return self.request(
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:484: in request
    return super().request(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:837: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:926: in send
    response = self._send_handling_auth(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:954: in _send_handling_auth
    response = self._send_handling_redirects(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:991: in _send_handling_redirects
    response = self._send_single_request(request)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1027: in _send_single_request
    response = transport.handle_request(request)
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:377: in handle_request
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:374: in handle_request
    portal.call(self.app, scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:456: in result
    return self.__get_result()
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../../miniconda3/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:715: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:735: in app
    await route.handle(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:301: in app
    raw_response = await run_endpoint_function(
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:214: in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
../../miniconda3/lib/python3.13/site-packages/starlette/concurrency.py:39: in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
../../miniconda3/lib/python3.13/site-packages/anyio/to_thread.py:56: in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:2441: in run_sync_in_worker_thread
    return await future
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:943: in run
    result = context.run(func, *args)
app/users.py:27: in create_user
    password_hash=security.hash_password(user_in.password),
app/security.py:9: in hash_password
    return pwd_context.hash(password)
../../miniconda3/lib/python3.13/site-packages/passlib/context.py:2258: in hash
    return record.hash(secret, **kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:779: in hash
    self.checksum = self._calc_checksum(secret)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:591: in _calc_checksum
    self._stub_requires_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2254: in _stub_requires_backend
    cls.set_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2156: in set_backend
    return owner.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2163: in set_backend
    return cls.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2188: in set_backend
    cls._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2311: in _set_backend
    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2224: in _set_backend
    ok = loader(**kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:626: in _load_backend_mixin
    return mixin_cls._finalize_backend_mixin(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:421: in _finalize_backend_mixin
    if detect_wrap_bug(IDENT_2A):
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:380: in detect_wrap_bug
    if verify(secret, bug_hash):
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:792: in verify
    return consteq(self._calc_checksum(secret), chk)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <passlib.handlers.bcrypt._BcryptBackend object at 0x11365ec10>
secret = b'01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345...7890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234'

    def _calc_checksum(self, secret):
        # bcrypt behavior:
        #   secret must be bytes
        #   config must be ascii bytes
        #   returns ascii bytes
        secret, ident = self._prepare_digest_args(secret)
        config = self._get_config(ident)
        if isinstance(config, unicode):
            config = config.encode("ascii")
>       hash = _bcrypt.hashpw(secret, config)
E       ValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])

../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:655: ValueError
----------------------------- Captured stdout call -----------------------------
DEBUG: Hashing password 'password123', type: <class 'str'>, length: 11
2025-12-01 23:35:39 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
------------------------------ Captured log call -------------------------------
WARNING  passlib.handlers.bcrypt:bcrypt.py:622 (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
___________________________ test_delete_calculation ____________________________

client = <starlette.testclient.TestClient object at 0x1131b49d0>
db_session = <sqlalchemy.orm.session.Session object at 0x1131b4c30>

    def test_delete_calculation(client, db_session):
>       client.post("/users/register", json={"username": "deluser", "email": "del@example.com", "password": "password123"})

tests/integration/test_calculation_routes.py:56: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:593: in post
    return super().post(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1157: in post
    return self.request(
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:484: in request
    return super().request(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:837: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:926: in send
    response = self._send_handling_auth(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:954: in _send_handling_auth
    response = self._send_handling_redirects(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:991: in _send_handling_redirects
    response = self._send_single_request(request)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1027: in _send_single_request
    response = transport.handle_request(request)
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:377: in handle_request
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:374: in handle_request
    portal.call(self.app, scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:456: in result
    return self.__get_result()
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../../miniconda3/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:715: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:735: in app
    await route.handle(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:301: in app
    raw_response = await run_endpoint_function(
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:214: in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
../../miniconda3/lib/python3.13/site-packages/starlette/concurrency.py:39: in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
../../miniconda3/lib/python3.13/site-packages/anyio/to_thread.py:56: in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:2441: in run_sync_in_worker_thread
    return await future
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:943: in run
    result = context.run(func, *args)
app/users.py:27: in create_user
    password_hash=security.hash_password(user_in.password),
app/security.py:9: in hash_password
    return pwd_context.hash(password)
../../miniconda3/lib/python3.13/site-packages/passlib/context.py:2258: in hash
    return record.hash(secret, **kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:779: in hash
    self.checksum = self._calc_checksum(secret)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:591: in _calc_checksum
    self._stub_requires_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2254: in _stub_requires_backend
    cls.set_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2156: in set_backend
    return owner.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2163: in set_backend
    return cls.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2188: in set_backend
    cls._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2311: in _set_backend
    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2224: in _set_backend
    ok = loader(**kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:626: in _load_backend_mixin
    return mixin_cls._finalize_backend_mixin(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:421: in _finalize_backend_mixin
    if detect_wrap_bug(IDENT_2A):
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:380: in detect_wrap_bug
    if verify(secret, bug_hash):
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:792: in verify
    return consteq(self._calc_checksum(secret), chk)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <passlib.handlers.bcrypt._BcryptBackend object at 0x1131b1ef0>
secret = b'01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345...7890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234'

    def _calc_checksum(self, secret):
        # bcrypt behavior:
        #   secret must be bytes
        #   config must be ascii bytes
        #   returns ascii bytes
        secret, ident = self._prepare_digest_args(secret)
        config = self._get_config(ident)
        if isinstance(config, unicode):
            config = config.encode("ascii")
>       hash = _bcrypt.hashpw(secret, config)
E       ValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])

../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:655: ValueError
----------------------------- Captured stdout call -----------------------------
DEBUG: Hashing password 'password123', type: <class 'str'>, length: 11
2025-12-01 23:35:40 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
------------------------------ Captured log call -------------------------------
WARNING  passlib.handlers.bcrypt:bcrypt.py:622 (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
________________________ test_invalid_calculation_type _________________________

client = <starlette.testclient.TestClient object at 0x11266e570>
db_session = <sqlalchemy.orm.session.Session object at 0x1123db890>

    def test_invalid_calculation_type(client, db_session):
>       client.post("/users/register", json={"username": "invaliduser", "email": "invalid@example.com", "password": "password123"})

tests/integration/test_calculation_routes.py:68: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:593: in post
    return super().post(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1157: in post
    return self.request(
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:484: in request
    return super().request(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:837: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:926: in send
    response = self._send_handling_auth(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:954: in _send_handling_auth
    response = self._send_handling_redirects(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:991: in _send_handling_redirects
    response = self._send_single_request(request)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1027: in _send_single_request
    response = transport.handle_request(request)
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:377: in handle_request
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:374: in handle_request
    portal.call(self.app, scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:456: in result
    return self.__get_result()
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../../miniconda3/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:715: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:735: in app
    await route.handle(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:301: in app
    raw_response = await run_endpoint_function(
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:214: in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
../../miniconda3/lib/python3.13/site-packages/starlette/concurrency.py:39: in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
../../miniconda3/lib/python3.13/site-packages/anyio/to_thread.py:56: in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:2441: in run_sync_in_worker_thread
    return await future
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:943: in run
    result = context.run(func, *args)
app/users.py:27: in create_user
    password_hash=security.hash_password(user_in.password),
app/security.py:9: in hash_password
    return pwd_context.hash(password)
../../miniconda3/lib/python3.13/site-packages/passlib/context.py:2258: in hash
    return record.hash(secret, **kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:779: in hash
    self.checksum = self._calc_checksum(secret)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:591: in _calc_checksum
    self._stub_requires_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2254: in _stub_requires_backend
    cls.set_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2156: in set_backend
    return owner.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2163: in set_backend
    return cls.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2188: in set_backend
    cls._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2311: in _set_backend
    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2224: in _set_backend
    ok = loader(**kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:626: in _load_backend_mixin
    return mixin_cls._finalize_backend_mixin(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:421: in _finalize_backend_mixin
    if detect_wrap_bug(IDENT_2A):
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:380: in detect_wrap_bug
    if verify(secret, bug_hash):
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:792: in verify
    return consteq(self._calc_checksum(secret), chk)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <passlib.handlers.bcrypt._BcryptBackend object at 0x1131c5400>
secret = b'01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345...7890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234'

    def _calc_checksum(self, secret):
        # bcrypt behavior:
        #   secret must be bytes
        #   config must be ascii bytes
        #   returns ascii bytes
        secret, ident = self._prepare_digest_args(secret)
        config = self._get_config(ident)
        if isinstance(config, unicode):
            config = config.encode("ascii")
>       hash = _bcrypt.hashpw(secret, config)
E       ValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])

../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:655: ValueError
----------------------------- Captured stdout call -----------------------------
DEBUG: Hashing password 'password123', type: <class 'str'>, length: 11
2025-12-01 23:35:40 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
------------------------------ Captured log call -------------------------------
WARNING  passlib.handlers.bcrypt:bcrypt.py:622 (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
_______________________ test_create_user_and_uniqueness ________________________

client = <starlette.testclient.TestClient object at 0x1131e56a0>
db_session = <sqlalchemy.orm.session.Session object at 0x1131e5ae0>

    def test_create_user_and_uniqueness(client, db_session):
>       response = client.post(
            "/users/register",
            json={"username": "alice", "email": "alice@example.com", "password": "password123"},
        )

tests/integration/test_user_model_and_endpoints.py:5: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:593: in post
    return super().post(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1157: in post
    return self.request(
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:484: in request
    return super().request(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:837: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:926: in send
    response = self._send_handling_auth(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:954: in _send_handling_auth
    response = self._send_handling_redirects(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:991: in _send_handling_redirects
    response = self._send_single_request(request)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1027: in _send_single_request
    response = transport.handle_request(request)
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:377: in handle_request
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:374: in handle_request
    portal.call(self.app, scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:456: in result
    return self.__get_result()
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../../miniconda3/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:715: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:735: in app
    await route.handle(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:301: in app
    raw_response = await run_endpoint_function(
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:214: in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
../../miniconda3/lib/python3.13/site-packages/starlette/concurrency.py:39: in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
../../miniconda3/lib/python3.13/site-packages/anyio/to_thread.py:56: in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:2441: in run_sync_in_worker_thread
    return await future
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:943: in run
    result = context.run(func, *args)
app/users.py:27: in create_user
    password_hash=security.hash_password(user_in.password),
app/security.py:9: in hash_password
    return pwd_context.hash(password)
../../miniconda3/lib/python3.13/site-packages/passlib/context.py:2258: in hash
    return record.hash(secret, **kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:779: in hash
    self.checksum = self._calc_checksum(secret)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:591: in _calc_checksum
    self._stub_requires_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2254: in _stub_requires_backend
    cls.set_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2156: in set_backend
    return owner.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2163: in set_backend
    return cls.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2188: in set_backend
    cls._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2311: in _set_backend
    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2224: in _set_backend
    ok = loader(**kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:626: in _load_backend_mixin
    return mixin_cls._finalize_backend_mixin(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:421: in _finalize_backend_mixin
    if detect_wrap_bug(IDENT_2A):
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:380: in detect_wrap_bug
    if verify(secret, bug_hash):
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:792: in verify
    return consteq(self._calc_checksum(secret), chk)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <passlib.handlers.bcrypt._BcryptBackend object at 0x112cfac10>
secret = b'01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345...7890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234'

    def _calc_checksum(self, secret):
        # bcrypt behavior:
        #   secret must be bytes
        #   config must be ascii bytes
        #   returns ascii bytes
        secret, ident = self._prepare_digest_args(secret)
        config = self._get_config(ident)
        if isinstance(config, unicode):
            config = config.encode("ascii")
>       hash = _bcrypt.hashpw(secret, config)
E       ValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])

../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:655: ValueError
----------------------------- Captured stdout call -----------------------------
DEBUG: Hashing password 'password123', type: <class 'str'>, length: 11
2025-12-01 23:35:41 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
------------------------------ Captured log call -------------------------------
WARNING  passlib.handlers.bcrypt:bcrypt.py:622 (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
_______________________________ test_login_user ________________________________

client = <starlette.testclient.TestClient object at 0x11329bac0>
db_session = <sqlalchemy.orm.session.Session object at 0x11329b9b0>

    def test_login_user(client, db_session):
        # Register user
>       client.post(
            "/users/register",
            json={"username": "bob", "email": "bob@example.com", "password": "password123"},
        )

tests/integration/test_user_model_and_endpoints.py:32: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:593: in post
    return super().post(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1157: in post
    return self.request(
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:484: in request
    return super().request(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:837: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:926: in send
    response = self._send_handling_auth(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:954: in _send_handling_auth
    response = self._send_handling_redirects(
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:991: in _send_handling_redirects
    response = self._send_single_request(request)
../../miniconda3/lib/python3.13/site-packages/httpx/_client.py:1027: in _send_single_request
    response = transport.handle_request(request)
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:377: in handle_request
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/testclient.py:374: in handle_request
    portal.call(self.app, scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:456: in result
    return self.__get_result()
../../miniconda3/lib/python3.13/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../../miniconda3/lib/python3.13/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../../miniconda3/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../../miniconda3/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:715: in __call__
    await self.middleware_stack(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:735: in app
    await route.handle(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../miniconda3/lib/python3.13/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:301: in app
    raw_response = await run_endpoint_function(
../../miniconda3/lib/python3.13/site-packages/fastapi/routing.py:214: in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
../../miniconda3/lib/python3.13/site-packages/starlette/concurrency.py:39: in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
../../miniconda3/lib/python3.13/site-packages/anyio/to_thread.py:56: in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:2441: in run_sync_in_worker_thread
    return await future
../../miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:943: in run
    result = context.run(func, *args)
app/users.py:27: in create_user
    password_hash=security.hash_password(user_in.password),
app/security.py:9: in hash_password
    return pwd_context.hash(password)
../../miniconda3/lib/python3.13/site-packages/passlib/context.py:2258: in hash
    return record.hash(secret, **kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:779: in hash
    self.checksum = self._calc_checksum(secret)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:591: in _calc_checksum
    self._stub_requires_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2254: in _stub_requires_backend
    cls.set_backend()
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2156: in set_backend
    return owner.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2163: in set_backend
    return cls.set_backend(name, dryrun=dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2188: in set_backend
    cls._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2311: in _set_backend
    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:2224: in _set_backend
    ok = loader(**kwds)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:626: in _load_backend_mixin
    return mixin_cls._finalize_backend_mixin(name, dryrun)
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:421: in _finalize_backend_mixin
    if detect_wrap_bug(IDENT_2A):
../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:380: in detect_wrap_bug
    if verify(secret, bug_hash):
../../miniconda3/lib/python3.13/site-packages/passlib/utils/handlers.py:792: in verify
    return consteq(self._calc_checksum(secret), chk)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <passlib.handlers.bcrypt._BcryptBackend object at 0x1131c78c0>
secret = b'01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345...7890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234'

    def _calc_checksum(self, secret):
        # bcrypt behavior:
        #   secret must be bytes
        #   config must be ascii bytes
        #   returns ascii bytes
        secret, ident = self._prepare_digest_args(secret)
        config = self._get_config(ident)
        if isinstance(config, unicode):
            config = config.encode("ascii")
>       hash = _bcrypt.hashpw(secret, config)
E       ValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])

../../miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py:655: ValueError
----------------------------- Captured stdout call -----------------------------
DEBUG: Hashing password 'password123', type: <class 'str'>, length: 11
2025-12-01 23:35:41 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
------------------------------ Captured log call -------------------------------
WARNING  passlib.handlers.bcrypt:bcrypt.py:622 (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/Users/kishorereddy/miniconda3/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'

---------- coverage: platform darwin, python 3.13.2-final-0 ----------
Name                  Stmts   Miss  Cover   Missing
---------------------------------------------------
app/__init__.py           1      0   100%
app/calculations.py      70     54    23%   13-14, 18-21, 26-68, 72-98, 102-108
app/db.py                 7      0   100%
app/factory.py           14      7    50%   23-30
app/models.py            18      0   100%
app/operations.py        27      0   100%
app/schemas.py           25      0   100%
app/security.py           7      1    86%   13
app/users.py             36     23    36%   15-19, 29-36, 46-59
---------------------------------------------------
TOTAL                   205     85    59%
Coverage HTML written to dir htmlcov

=========================== short test summary info ============================
FAILED tests/integration/test_calculation_routes.py::test_create_calculation
FAILED tests/integration/test_calculation_routes.py::test_read_calculations
FAILED tests/integration/test_calculation_routes.py::test_read_calculation_by_id
FAILED tests/integration/test_calculation_routes.py::test_update_calculation
FAILED tests/integration/test_calculation_routes.py::test_delete_calculation
FAILED tests/integration/test_calculation_routes.py::test_invalid_calculation_type
FAILED tests/integration/test_user_model_and_endpoints.py::test_create_user_and_uniqueness
FAILED tests/integration/test_user_model_and_endpoints.py::test_login_user - ...
========================= 8 failed, 6 passed in 3.54s ==========================
